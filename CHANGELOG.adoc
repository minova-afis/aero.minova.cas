# Changelog
All wesentlichen Änderungen für dieses Projekt werden hier dokumentiert.

Das Format basiert auf link:https://keepachangelog.com/en/1.0.0[Keep a Changelog].

## [UNRELEASED] -- XXXX-XX-XX
* Spring Security: Umstellung von `WebSecurityConfigurerAdapter` auf Komponenten-basierende Sicherheit
* Aktualisierung Java 11 LTS auf Java 17 LTS
* Aktualisierung von JavaX auf Jakarta
* Update auf SpringBoot 3.0.0
* `@SpringBootApplication` Annotation OHNE `exclude = { DataSourceAutoConfiguration.class }`, damit automatisch eine `entityManagerFactory` erstellt wird.
* BUGFIX: Für die LDAP-Gruppen wird `xtcasUser` statt der `xtcasUsers` ausgelesen, um die SecurityTokens zu bestimmen.
* Rechtevergabe durch AuthorizationController erleichtern, indem dies durch JPA umgesetzt wird und somit auch Datenbank unabhängig ist.

## [12.56.2] -- 2023-01-10
* Tabellen um Hilfsmethoden erweitert, mit der leichter auf Values zugegriffen werden kann
* toString Methoden Tabellen, Columns, Rows und Values ausbessern
* Auch "com.minova" bei @EntityScan und @EnableJpaRepositories beachten

## [12.56.1] -- 2023-12-09
* Richtiger Release zum Verwenden von CAS als Abhängigkeit

## [12.56.0] -- 2022-12-01
* toString-Methode für Tabellen, Columns, Rows und Values erstellen.
* Die Datei application.mdi wird jetzt anhand der xtcasMdi-Tabelle benutzerspezifisch erzeugt.
* Prüfung auf validen Input für Passwörter beim Inserten und Updaten von DB Usern.
* Auslesen von UserGroupTokens für DB User bei Anfragen.
* SQL-Fehler beim Setup beheben.
* Erhöhe Jackson-dataformat-xml von Version 2.13.3 nach 2.14.0

## [12.55.1] -- 2022-11-22
* LDAP: Raise an Active Directory-specific error code instead of a BadCredentialsException
* Username Spaltenlänge in Error Table korrigiert
* Mdi Masken, Tabelle und Prozeduren erstellt(samt Icon und Übersetzung)
* Initialisierungs Prozedur und Skript erstellt
* Icon Schrott beseitigt

## [12.55.0] -- 2022-11-11
* Korrekturen der UserGroup Prozeduren. Sie verwenden nun nicht mehr den UserCode, sondern den KeyText der UserGroup.
* Korrektur xpcasInsertAuthorities. Es konnte über die Authorities ein Benutzer nur einer UserGruppe zugeordnet werden.
* Weitere Übersetzungen für die UserGroup Masken und OptionPages.
* Korrektur xpcasDeleteAuthorities. Obwohl die Authority auf -1 gestellt wurde, hatte man trotzdem volle Rechte. Nun wird sie ganz gelöscht.
* Neue Icons.
* Update auf SpringBoot 2.7.5

## [12.54.3] -- 2022-09-30

Keine Änderungen 

## [12.54.2] -- 2022-09-29
* Tabellenbezeichnung von xtcasUserPrivileges korrigieren.

## [12.54.1] -- 2022-09-29
* Releaseprozess für Helper korrigieren.

## [12.54.0] -- 2022-09-29
* #293 Standardmasken zum Verwalten von Benutzern einbinden.
* Helper zum Verschlüsseln von Passwörtern innerhalb der Maske.

## [12.53.0] -- 2022-09-13
* devWarning in "dev"-Profile verschoben
* link:https://github.com/minova-afis/aero.minova.cas/issues/368[#368] ServiceProperties Tabelle und Maske erstellen:
  Hiermit werden zukünftig Dienste über link:https://github.com/minova-afis/aero.minova.service[aero.minova.service] konfiguriert.
  Damit kann man Dienste über eine Maske und somit ohne Dateizugriff einfach und dennoch sicher konfigurieren.

## [12.52.0] -- 2022-09-02
* Profil für Dev-System, um CORS für Entwicklungszwecke zu erlauben

## [12.51.0] -- 2022-08-30
* Update auf SpringBoot 2.7.3

## [12.50.0] -- 2022-08-30
* #320 Code aufräumen: Datenbankzurgriffe aus den Controllern in einene Service-Klassen verschieben.

## [12.49.0] -- 2022-08-30
* Basis-Docker-Image von Adoptium verwenden und dessen Einsatz begründen.
* #300 Long als Value unterstützen.
* #184 Tests zum Beweisen, dass Http2 Property funktionieren würde, hinzufügen.
* BUGFIX: Initialisieren des CAS API Objektes mit eigener JSON Instanz.
* Code aufräumen: Nicht verwendete Ordner `Program Files` und `Shared Date` aus `FileService` entfernen.
* `org.apache.xmlbeans:xmlbeans`-Abhängigkeit aus Setup-Extension entfernen und dadurch Abhängigkeit-Updates in der Zukunft vereinfachen.
  Vorher hatten wir die Version 3 verwendet und konnten nicht einfach auf die Version 5 aktualisieren.
  Zudem wurde aus dem Install-Tool-Code nicht verwendeter Code entfernt.
  Auch konnten wir die Binaries aus `setup/libs/*` hiermit entfernen.

## [12.48.0] -- 2022-07-20
* #217 Es wird nicht mehr bei jedem SQL-Aufruf erwartet, dass die View/Tabelle einen KeyLong besitzt.
* #341 BUGFIX: Kein Commit mehr zwischen XProcedures.
* Ein weiteres Format von Fehlermeldungen unterstützen: 'ADO|Zahl|Fehlermeldung'
* CAS-Client-API um die Methode `sendGenericProcedureRequest` erweitern, um beliebige Objekte von `data/procedure` abzufragen.
Dies ist besonders nützlich, wenn beispielsweise ein PDF-Report vom CAS abgefragt wird.

## [12.47.1] - 2022-06-24
* #274 Fehlermeldungen, welche nicht mit 'msg.' beginnen, verarbeitbar machen.
* #291 Doku für Logs hinzugefügt.

## [12.47.0] - 2022-06-17
* API für Extensions, welche Nachrichten an einen Dienst schicken möchten.

## [12.46.0 - 12.46.1] - 2022-06-09
* Neue Property(aero.minova.database.maxResultSetCount) für application.properties, wird für SQL-Prozeduren ausgewertet, um größere Rückgabewerte zu Erlauben.
* Update auf SpringBoot 2.7.0: MS-SQL Dependency wurde von 9.x auf 10.x aktualisiert. Das heißt der Wert für `encrypt` ist nun per Default `true`. Siehe `support.adoc` und https://github.com/spring-projects/spring-boot/issues/31157

## [12.45.0] - 2022-05-25

* Erstelle Standard-Prozedur-Erweiterung `xpcasEncodePassword` damit der Nutzer keine Entwicklungsumgebung braucht,
um Passwörter zu hashen.
* Einbinden des ServiceNotifierServices in den QueueService, damit Dienstextensions Listener registrieren können, ohne dass NullPointerExceptions geworfen werden.
* Integration von SonarQube, OWASP Dependency-Check und JaCoCo in die CI-Pipeline
* Update auf SpringBoot 2.6.7
# Update weiterer Abhängigkeiten

## [12.44.1] - 2022-05-19

* Korrektur des ServiceNotifierServices, damit NewsfeedListener angelegt werden können.
* Automatisches Anlegen eines Admins mit *allen* Rechten am Ende des Setups.
* Auslagern der Cache Methoden aus dem ServiceNotifierService.

## [12.44.0] - 2022-05-13

* #305 Keytext-Spalte der xtcasUserPrivilege-Tabelle vergrößern.
* Setup wieder durchfürbar machen.
* Falls ein Fehler während des Setups auftritt, wird nun die korrekte HTTPServletResponse zurückgegeben.

## [12.43.0 ] - 2022-05-05
* registerServiceMessage-Methode im QueueService korrigieren.
* #299 Vorsilbe 'xpcor' für die Prozeduren des ServiceNotifierService ergänzen.
* #303 SpringBoot: /actuator ist auf dem Management-Port 8081 zu finden. Per Konfiguration `management.endpoints.enabled-by-default=false` sind alle weiteren Endpunkte deaktiviert.
* #302 Extensions aus Kunden-Projekten mit Group-Id 'com.minova' unterstützen.

## [12.42.0 ] - 2022-05-02
* #281: Logs aus Tests in den target-Ordner schreiben, damit diese nicht ausversehen commited werden.

* Automatisches Speichern, Queueing und Versenden von Nachrichten an andere Dienste implementieren.

## [12.41.2 - 12.41.3] - 2022-04-29

Kompatibilitäts-Projekt `aero.monova.core.application.system.app` erstellen,
um einen Setup-Fehler zu beheben zu können.
Siehe das link:doc/adoc/support.adoc[Support-Dokument] and link:app.legacy/README.adoc[Kompatibilitäts-Projekts-README] für Details.

## [12.41.1] - 2022-04-25
IsTablePresent-Methode public setzen.
Es werden Änderungen aus aero.minova.cas.service für die Implementierung benötigt, deshalb der Release.

## [12.41.0] - 2022-04-25

Experimentelle CAS-Erweiterung aero.minova.cas.servicenotifier an Änderungen anpassen.
Es werden Änderungen aus aero.minova.cas.service für die Implementierung benötigt, deshalb der Release.

## [12.40.4] - 2022-04-19

Experimentelle CAS-Erweiterung aero.minova.cas.servicenotifier für die Registrierung von Diensten erstellen.
Es werden Änderungen aus aero.minova.cas.service für die Implementierung benötigt, deshalb der Release.

## [12.40.3] - 2022-04-19

Inkompatiblen Änderungen: Umbenennen der Methode getTableForSecurityCheck nach unsecurelyGetIndexView in aero.minova.cas.service.

## [12.40.1] - 2022-04-08

Privilegienprüfung auf Prozeduren in PostgreSQL unterstützen.

## [12.40.0] - 2022-04-07

Ordner, Paket und Projekt-Namen vereinheitlichen:

* Die Pakete `aero.minova.core.application.system.*` wurden nach `aero.minova.cas.*` umbenannt.
* Die Ordnernamen der Unterprojekte wurde verkürtzt indem der `aero.minova.core.application.system.` Prefix entfernt wurde.
  Dadurch sind die Ordner einfacher voneinander zu unterscheiden.

## [12.39.0] - 2022-04-04

Postgresql bei der Privilegienprüfung unterstützen.

## [12.38.4] - 2022-03-31

BUGFIX: Beim Aufruf von XProcedures wurde das Result nicht zurückgegeben. Dies ist nun korrigiert.

## [12.38.3] - 2022-03-30

Alle CAS-Abhängigkeiten in den POM auf die neuste Version abgedated.

## [12.38.2] - 2022-03-30

BUGFIX: Doppelte Gson-Bean Erstellung unterbinden. Dadurch konnte das CAS nicht mehr starten.

## [12.38.1] - 2022-03-30

Verwenden der neuen CAS API als Abhängigkeit im CAS.

## [12.38.0] - 2022-03-28

Bereitstellen des aero.minova.cas.api-Moduls, welches Kern-Klassen zum Austausch von HTTP-Anfragen an das CAS enthält.

## [12.37.0] - 2022-03-23

Erweiterungen von Views können nun registriert werden.

## [12.36.5] - 2022-03-17

`upload/logs` Ursache für Entpackungs-Probleme der hochgeladenen Datei loggen und zurückgeben.

## [12.36.4] - 2022-03-04

Korrektur der ForeignKey-Constraints von xtcasAuthorities.

## [12.36.3] - 2022-03-02

#254 Automatische Setup der Tabellen xtcasUsers und xtcasAuthorities.
Diese Tabellen werden benötigt, damit Benutzer-Logins und deren Security-Token-Zuweisung für Nutzer über im SQL-Server gespeichert und geladen werden können.

Automatische Admin-Rolle erstellen nach einem erfolgreichen Setup.

## [12.36.2] - 2022-02-22

Korrektes Anzeigen der letzten Seite einer View.

## [12.36.1] - 2022-02-15

Fehlende Prozedur im Setup hinzugefügt.

## [12.36.0] - 2022-02-15

Es wird nun ein eigener Logger für das Setup verwendet.

Fehlermeldungen können nun auf zwei verschiedene Arten verarbeitet und dargestellt werden.

## [12.39.3] - 2022-04-07

Die Packete `aero.minova.core.application.system.*` nach `aero.minova.cas.*` umbenennen
und Ordnerstruktur übersichtlicher gestalten.

## [12.35.0] - 2022-02-08

Es können nun auch Kundenprojekte als Abhängigkeit in anderen Kundenprojekten angegeben werden. 
Sie werden beim Setup nun richtig verarbeitet.


## [12.34.2] - 2022-01-11

core.application.system.service nutzt nun cas.client für die Kern-Klassen.
cas.client Package-Namen angepasst. 

## [12.34.1] - 2022-01-11

Kern-Klassen in cas.client-Unterprojekt ausgelagert.

## [12.34.0] - 2022-01-11

Die Extensions werden nun beim Setup-Befehl mitinstalliert.

## [12.33.1] - 2022-01-07

Einführen einer Methode, um Prozeduren ungeprüft/ ohne Rechte ausführen zu können.

## [12.33.0] - 2021-12-17

Der Setup-Befehl kann nun über die Web-Oberfläche ausgeführt werden.

## [12.32.0] - 2021-12-15

Property `app.log.root` einführen, um die Log-Ordner für die Anwendung zu setzen.

## [12.31.2] - 2021-12-09

* Rekursive Extensions-Aufrufe nicht mit Semaphor blockieren.

## [12.31.1] - 2021-12-09

* Bei der Ausführung von SQL-Prozedur-Erweiterungen wird eine Semaphore verwendet, welche verhindert, dass sich die Extension beim Ausführen in die Quere kommen.
* Beim der Setup-Extension werdend die SQL-Queries jetzt alle mit -fs ausgeführt.

## [12.30.0] - 2021-12-08

* Bei der Ausführung von SQL-Prozeduren werden update counts ignoriert,
um die erste ResultSet zu finden.

* Die Methode `SqlProcedureController#calculateSqlProcedureResult` für Erweiterungen bereitstellen.

## [12.28.7] - 2021-12-01

Nach Transaktionen werden nun TransaktionChecker-Prozeduren ausgeführt.

## [12.28.4] - 2021-11-30

Bugfixes für das Laden von Privilegien aus der Datenbank
für die Autorisierung.

## [12.28.0] - 2021-11-19

Abhängigkeiten für SOAP-Webdienste werden durch die Setup-Extension zur Verfügung gestellt.

## [12.27.0] - 2021-11-18

 * (#211) Es können jetzt Transaktionen (Liste einander abhängender Prozeduren mit IDs) ausgeführt werden.
 * Ein Bug wurde gefixed, bei welchem beim Ausführen von Prozeduren nach der SecurityToken-Spalte gesucht wurde, obwohl die RowLevelSecurity nicht aktiviert war.

## [12.25.0] - 2021-11-02

Die Reihenfolge in welcher Dependencies über die `data/procedure` Setup installiert werden,
wurde an die Version 12.5.0 von
link:https://github.com/minova-afis/aero.minova.app.parent/blob/main/CHANGELOG.md#1250---2021-11-03[aero.minova.app.parent]
angepasst.
Ab dieser CAS-Version,
müssen folglich alle Kundenprojekte auf diese `app.parent`-Version umgestellt werden.

## [12.24.1] - 2021-10-25

Setup-Fehler beheben.

## [12.24.0] - 2021-10-13

* #149: Der Nutzer von Prozedur-Aufrufen über `data/procedure` wird im SQL-Session-Context `casUser` abgelegt
  und kann mit der Funktion `dbo.xfCasUser()` ermittelt werden.
  Der Nutzer der SQL-Session kann nicht genutzt werden, da dies immer der SQL-Nutzer des CAS-Dienstes ist.

## [12.21.28] - 2021-09-17

* Installierbares Docker-Image erstellen.
* Vorherige Versionen sind hier nicht dokumentiert.
